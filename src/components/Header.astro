---
import HeaderLink from './HeaderLink.astro';
import { SITE_TITLE } from '../consts';

const rawBase = import.meta.env.BASE_URL || '/';
const base = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;
const link = (p: string = '') => `${base}${p}`;
---

<header class="site-header">
  <!-- ===== DESKTOP NAV (your original) ===== -->
  <nav class="desktop-nav">
    <h2><a href={base}>{SITE_TITLE}</a></h2>
    <div class="internal-links" id="desktop-links">
      <HeaderLink href={link('')} exact>Home</HeaderLink>
      <HeaderLink href={link('blog/')}>Blog</HeaderLink>
      <HeaderLink href={link('templates/')}>Templates</HeaderLink>
      <HeaderLink href={link('projects/')}>Projects</HeaderLink>
      <HeaderLink href={link('books/')}>Books</HeaderLink>
      <HeaderLink href={link('albums/')}>Albums</HeaderLink>
      <HeaderLink href={link('art/')}>Art</HeaderLink>
      <HeaderLink href={link('guitar/')}>Guitar</HeaderLink>
      <HeaderLink href={link('inspirations/')}>Inspirations</HeaderLink>
      <HeaderLink href={link('about/')}>About</HeaderLink>
    </div>
    <div class="contact-button">
      <a href="mailto:lifeloggerz.official@gmail.com">Contact</a>
    </div>
  </nav>

  <!-- ===== MOBILE NAV (separate, dropdown) ===== -->
  <nav class="mobile-nav">
    <h2 class="brand"><a href={base}>{SITE_TITLE}</a></h2>

    <details class="nav-toggle">
      <summary aria-label="Open menu">â˜°</summary>

      <div class="menu-panel">
        <div class="internal-links">
          <HeaderLink href={link('')}>Home</HeaderLink>
          <HeaderLink href={link('blog/')}>Blog</HeaderLink>
          <HeaderLink href={link('templates/')}>Templates</HeaderLink>
          <HeaderLink href={link('books/')}>Books</HeaderLink>
          <HeaderLink href={link('albums/')}>Albums</HeaderLink>
          <HeaderLink href={link('art/')}>Art</HeaderLink>
          <HeaderLink href={link('inspirations/')}>Inspirations</HeaderLink>
          <HeaderLink href={link('guitar/')}>Guitar</HeaderLink>
          <HeaderLink href={link('projects/')}>Projects</HeaderLink>
          <HeaderLink href={link('about/')}>About</HeaderLink>
        </div>
        <a class="contact-btn" href="mailto:smartstuffstays@gmail.com">Contact</a>
      </div>
    </details>
  </nav>
</header>

<style>
  /* Shared shell */
  .site-header {
    margin: 0;
    padding: 0 1rem;
    background: #fff;
    box-shadow: 0 2px 8px rgba(0,0,0,.05);
    position: sticky; top: 0; z-index: 50;
  }

  /* ===== DESKTOP styles (exactly like your original) ===== */
  .desktop-nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .5rem;
  }
  .desktop-nav h2 { margin: 0; font-size: 1em; }
  .desktop-nav h2 a,
  .desktop-nav h2 a.active { text-decoration: none; color: var(--black, #0e121b); font-weight: 600; }
  .desktop-nav .internal-links { display: flex; flex-wrap: nowrap; gap: .25rem; }
  .desktop-nav .internal-links :global(a) {
    padding: 1em .5em;
    color: var(--black, #0e121b);
    border-bottom: 4px solid transparent;
    text-decoration: none;
  }
  .desktop-nav .internal-links :global(a.active) { border-bottom-color: var(--accent, #405cf5); }
  .desktop-nav .contact-button a {
    background: transparent; color: #2563eb; border: 2px solid #2563eb;
    padding: .5rem 1.1rem; border-radius: 9999px; font-weight: 600; transition: all .25s; text-decoration: none; white-space: nowrap;
  }
  .desktop-nav .contact-button a:hover { background:#2563eb; color:#fff; }

  /* ===== MOBILE nav (dropdown) ===== */
  .mobile-nav { display: none; align-items: center; justify-content: space-between; gap: .5rem; }
  .mobile-nav .brand { margin: 0; font-size: 1em; }
  .mobile-nav .brand a { text-decoration: none; color: var(--black, #0e121b); font-weight: 600; }

  .mobile-nav .nav-toggle > summary {
    display: inline-block;
    border: 1px solid rgba(0,0,0,.12);
    background: #fff;
    border-radius: .6rem;
    padding: .45rem .65rem;
    font-size: 1.15rem;
    line-height: 1;
    cursor: pointer;
    list-style: none;
    user-select: none;
  }
  .mobile-nav .nav-toggle > summary::-webkit-details-marker { display: none; }

  .mobile-nav .menu-panel {
    position: absolute; left: 0; right: 0; top: 100%;
    background: #fff; border-top: 1px solid rgba(0,0,0,.06);
    box-shadow: 0 8px 24px rgba(0,0,0,.06);
    display: none; flex-direction: column; align-items: stretch; padding: .25rem 0; z-index: 40;
  }
  .mobile-nav .nav-toggle[open] .menu-panel { display: flex; }

  .mobile-nav .internal-links {
    display: grid; grid-template-columns: 1fr 1fr; gap: 0;
  }
  .mobile-nav .internal-links :global(a) {
    padding: .85rem 1rem;
    border-bottom: 1px solid rgba(0,0,0,.04);
    color: var(--black, #0e121b);
    text-decoration: none;
  }
  .mobile-nav .contact-btn {
    margin: .35rem 1rem .6rem; text-align: center;
    background: transparent; color: #2563eb; border: 2px solid #2563eb;
    padding: .5rem 1.1rem; border-radius: 9999px; font-weight: 600; transition: all .25s; text-decoration: none; white-space: nowrap;
  }
  .mobile-nav .contact-btn:hover { background:#2563eb; color:#fff; }

  /* ===== RESPONSIVE SWITCH ===== */
  @media (max-width: 900px) {
    .desktop-nav { display: none; }
    .mobile-nav { display: flex; position: relative; }
  }
</style>
