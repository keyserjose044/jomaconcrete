---
// src/pages/templates.astro
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BaseHead from '../components/BaseHead.astro';
import DownloadMeta from '../components/DownloadMeta.astro';

// GitHub Pagesâ€“safe base URL handling
const rawBase = import.meta.env.BASE_URL || '/';
const base = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;

type Item = {
  title: string;
  description?: string;
  href: string; // download link
  filetype: 'Google Sheet' | 'Excel' | 'PDF' | 'Word' | 'ZIP' | 'Other';
  updated?: string;
  imageSrc?: string;
  imageAlt?: string;
  imageOrientation?: 'portrait' | 'landscape';
  postUrl?: string; // optional blog post link
};

const templates: Item[] = [
  {
    title: '2026 Raw Data Template (Google Sheets)',
    description: 'My 2026 life-tracking template â€” cleaner visuals, smarter formulas, and script-ready.',
    href: 'https://docs.google.com/spreadsheets/d/1bSoK1QHIGkvxMBjmG478fghTF-sZX2KH99Wd-KS7WVI/edit?gid=1660968934#gid=1660968934',
    filetype: 'Google Sheet',
    updated: 'Oct 2025',
    imageSrc: `${base}images/2026cleanrawdatatemplate.png`,
    imageAlt: '2026 Raw Data Template preview',
    imageOrientation: 'landscape',
    postUrl: `${base}blog/rawdatapost2026/`,
    // ðŸ‘‡ ensures UI reads the same key the Worker writes
    downloadKey: 'template/2026-raw-data-template',
  },
  {
    title: 'Weekly To-Do List Template',
    description: 'Simple, customizable weekly list with weekday blocks.',
    href: `${base}templates/Original-To-Do-List-Template.docx`,
    filetype: 'Word',
    updated: 'Oct 2025',
    imageSrc: `${base}templates/covers/todo-cover.png`,
    imageAlt: 'Preview of the To-Do List Template',
    imageOrientation: 'portrait',
    postUrl: `${base}blog/original-to-do-list-template/`,
  },
  {
    title: 'Research Paper Fill-In Template',
    description: 'Structured template for organized paper notes.',
    href: `${base}templates/Research-Paper-Fill-In-Template.docx`,
    filetype: 'Word',
    updated: 'Oct 2025',
    imageSrc: `${base}templates/covers/research-template-cover.png`,
    imageAlt: 'Preview of the Research Paper Fill-In Template',
    imageOrientation: 'portrait',
    postUrl: `${base}blog/research-paper-fill-in-template/`,
  },
];
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead
      title="Templates â€¢ Downloads"
      description="Download LifeLoggerz templates and tools."
    />
    <style>
      :root {
        --bg: #ffffff;
        --text: #0e121b;
        --muted: #5b6473;
        --accent: #405cf5;
        --ring: rgba(64, 92, 245, 0.25);
        --card: #f8fafc;
        --border: #e5e7eb;
      }

      /* ===== Scoped hardening just for this page ===== */
      .templates-page,
      .templates-page * { box-sizing: border-box; }

      .templates-page {
        display: block;
        inline-size: 100%;
        max-inline-size: 1080px;
        margin-inline: auto;
        padding: 2rem 1rem 4rem;
        text-align: center;
        overflow-x: hidden;   /* kill horizontal drift */
        contain: layout;      /* isolate from global main{} rules */
      }

      .templates-page section,
      .templates-page article,
      .templates-page .content {
        min-width: 0;
        max-inline-size: 100%;
      }

      .templates-page img,
      .templates-page video,
      .templates-page figure {
        display: block;
        max-inline-size: 100%;
        height: auto;
        margin-inline: auto;
      }

      .page-title {
        margin: 1.5rem 0 0.5rem;
        font-size: clamp(1.6rem, 2.5vw, 2rem);
        font-weight: 800;
        overflow-wrap: anywhere;
      }

      .subtitle {
        color: var(--muted);
        margin-bottom: 2rem;
        font-size: 1.05rem;
        overflow-wrap: anywhere;
      }

      /* âœ… Responsive grid: no spans, no phantom columns */
      .grid {
        display: grid;
        gap: 1rem;
        grid-template-columns: repeat(auto-fit, minmax(min(320px, 100%), 1fr));
        justify-items: stretch;
        align-items: stretch;
        margin-inline: auto;
        inline-size: 100%;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        inline-size: 100%;   /* fill grid track */
        min-width: 0;        /* allow shrink */
        text-align: left;
        contain: content;    /* child overflow canâ€™t expand grid */
      }

      /* Image previews */
      .thumb {
        display: block;
        background: #f8fafc;
        border-bottom: 1px solid var(--border);
        overflow: hidden;
        border-radius: 16px 16px 0 0;
        inline-size: 100%;
      }
      .thumb.portrait { aspect-ratio: 3 / 4; }
      .thumb.landscape { aspect-ratio: 16 / 9; }
      .thumb img {
        inline-size: 100%;
        block-size: 100%;
        object-fit: contain;
        background: white;
        padding: 0.25rem;
        transition: transform 0.3s ease;
        display: block;
      }
      .thumb:hover img { transform: scale(1.03); }

      .content {
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        min-width: 0;
      }

      .eyebrow,
      .card h3,
      .desc,
      .meta {
        overflow-wrap: anywhere;
        word-break: break-word;
        min-width: 0;
        max-inline-size: 100%;
      }

      .eyebrow {
        font-size: 0.8rem;
        color: var(--muted);
        letter-spacing: 0.04em;
        text-transform: uppercase;
      }

      .card h3 {
        margin: 0.15rem 0 0.15rem;
        font-size: 1.05rem;
      }

      .desc { color: var(--muted); font-size: 0.95rem; }

      .meta {
        font-size: 0.85rem;
        color: var(--muted);
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .actions {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 0.6rem;
        min-width: 0;
        flex-wrap: wrap;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.6rem 1.2rem;
        border-radius: 9999px;
        font-weight: 700;
        border: 1px solid var(--accent);
        text-decoration: none;
        background: var(--accent);
        color: white;
        box-shadow: 0 6px 20px var(--ring);
        transition: transform 0.04s ease, box-shadow 0.2s ease, background 0.2s ease;
        max-inline-size: 100%;
      }
      .btn:hover { transform: translateY(-1px); }

      /* === Center text inside cards === */
      .card .content {
        text-align: center;
        align-items: center;
      }
      
      .card .meta {
        justify-content: center;
        text-align: center;
        width: 100%;
      }
      
      .card .desc,
      .card .eyebrow,
      .card h3 {
        text-align: center;
        margin-inline: auto;
      }


      /* ===== Mobile polish (desktop unaffected) ===== */
      @media (max-width: 768px) {
        .templates-page { padding-inline: clamp(1rem, 4vw, 2rem); }
        .grid { grid-template-columns: 1fr !important; justify-items: center; text-align: center; }
        .card { text-align: center; }
        .card h3 { font-size: clamp(1rem, 4.5vw, 1.15rem); }
      }
    </style>
  </head>

  <body>
    <Header />
    <main class="templates-page">
      <h1 class="page-title">Templates & Downloads</h1>
      <p class="subtitle">
        Ready-to-use files for time-tracking, research, and productivity.
      </p>

      <section class="grid">
        {templates.map((t) => (
          <article class="card">
            {t.imageSrc && (
              <a
                class:list={[
                  'thumb',
                  (t.imageOrientation ?? 'portrait') === 'landscape'
                    ? 'landscape'
                    : 'portrait',
                ]}
                href={t.postUrl ?? t.href}
              >
                <img src={t.imageSrc} alt={t.imageAlt ?? t.title} loading="lazy" />
              </a>
            )}
            <div class="content">
              <div class="eyebrow">{t.filetype}</div>
              <h3>{t.title}</h3>
              {t.description && <p class="desc">{t.description}</p>}
              <DownloadMeta href={t.href} updated={t.updated!} text="Download" />
            </div>
          </article>
        ))}
      </section>
    </main>
    <Footer />
  </body>
</html>
